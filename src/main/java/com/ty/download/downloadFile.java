package com.ty.download;

import com.ty.enums.ResultEnum;
import com.ty.exception.GlobalException;
import org.apache.commons.lang3.RandomStringUtils;
import org.apache.commons.lang3.StringUtils;
import org.springframework.util.Base64Utils;
import sun.misc.BASE64Decoder;
import sun.misc.BASE64Encoder;

import javax.servlet.http.HttpServletResponse;
import java.io.*;
import java.net.HttpURLConnection;
import java.net.URL;
import java.util.HashMap;
import java.util.Map;
import java.util.UUID;

/**
 * 下载文件
 *
 * @ClassName downloadFile
 * @Author tianye
 * @Date 2019/5/6 9:30
 * @Version 1.0
 */
public class downloadFile {

    /**
     * 文件类型
     */
    private final static String FILE_TYPE = "type";
    /**
     * base64转码
     */
    private final static String FILE_BASE64 = "base64";

    /**
     * 根据文件路径，转码base64
     * @param path
     * @return
     * @throws Exception
     */
    public static String encodeBase64File(String path) throws Exception {
        File file = new File(path);
        FileInputStream inputFile = new FileInputStream(file);
        byte[] buffer = new byte[(int) file.length()];
        inputFile.read(buffer);
        inputFile.close();
        return new BASE64Encoder().encode(buffer);
    }

    /**
     * 获取网络文件类型，并且编码为base64
     *
     * @param fileUrl
     * @return
     * @throws Exception
     */
    private Map<String, String> getFileTypeAndToBase64(String fileUrl) {
        //将图片文件转化为字节数组字符串，并对其进行Base64编码处理
        HttpURLConnection conn;
        Map<String, String> map = new HashMap<>();
        if (StringUtils.isBlank(fileUrl)) {
            throw new GlobalException(ResultEnum.RESULT_CODE_100500, "获取网络文件类型地址(url)为空!");
        }
        try {
            URL url = new URL(fileUrl);
            conn = (HttpURLConnection) url.openConnection();
            //设置请求方式为"GET"
            conn.setRequestMethod("GET");
            //超时响应时间为5秒
            conn.setConnectTimeout(5 * 1000);
            // 设置字符编码
            conn.setRequestProperty("Charset", "UTF-8");
            // 打开到此 URL 引用的资源的通信链接（如果尚未建立这样的连接）。
            conn.connect();

            // 文件名
            String filePathUrl = conn.getURL().getFile();
            filePathUrl = filePathUrl.replaceAll("[/;]", "\\\\");
            String fileFullName = filePathUrl.substring(filePathUrl.lastIndexOf(File.separatorChar) + 1);
            String fileType = fileFullName.substring(fileFullName.lastIndexOf(".") + 1);
            map.put(FILE_TYPE, fileType);

            // 如果上传的是压缩包，需要延迟1-2秒，否则有可能拿不到上传文件，会报FileNotFoundException
            if (StringUtils.equalsAny(fileType, "rar", "zip")) {
                Thread.sleep(1000);
            }

            //通过输入流获取图片数据
            InputStream inStream = conn.getInputStream();
            //得到图片的二进制数据，以二进制封装得到数据，具有通用性
            ByteArrayOutputStream outStream = new ByteArrayOutputStream();
            //创建一个Buffer字符串
            byte[] buffer = new byte[conn.getContentLength()];
            //每次读取的字符串长度，如果为-1，代表全部读取完毕
            int len;
            //使用一个输入流从buffer里把数据读取出来
            while ((len = inStream.read(buffer)) != -1) {
                //用输出流往buffer里写入数据，中间参数代表从哪个位置开始读，len代表读取的长度
                outStream.write(buffer, 0, len);
            }
            //关闭输入流
            inStream.close();
            //对字节数组Base64编码
            map.put(FILE_BASE64, Base64Utils.encodeToString(outStream.toByteArray()));
            return map;
        } catch (Exception e) {
            e.printStackTrace();
            throw new GlobalException(ResultEnum.RESULT_CODE_100500, "获取网络文件类型，并且编码为base64失败!");
        }
    }
    /**
     * 根据base64解码然后下载到客户端
     * @param response
     * @param filePath
     * @param type
     */
    public void printAsnBox(HttpServletResponse response, String filePath, String type) {
//        String fileName = UUID.randomUUID().toString().replaceAll("-", "");
        // 生成字母加数字组成的随机字符串
        String fileName = RandomStringUtils.randomAlphanumeric(12);
        try {
            // base64编码
//            String string = encodeBase64File(filePath);
            String string = "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YmUpIC9PcmRlcmluZyAoSWRlbnRpdHkpIC9TdXBwbGVtZW50IDAgPj4KL0ZvbnREZXNjcmlwdG9yIDE5IDAgUgovQ0lEVG9HSURNYXAgL0lkZW50aXR5Ci9XIFswIFs1OTUgMzg5IDYxMCA1MTcgNjMxIDYzMSA2MzEgNjMxIF0KXQo+PgplbmRvYmoKMjIgMCBvYmoKPDwgL0xlbmd0aCA0MTMgPj4Kc3RyZWFtCi9DSURJbml0IC9Qcm9jU2V0IGZpbmRyZXNvdXJjZSBiZWdpbgoxMiBkaWN0IGJlZ2luCmJlZ2luY21hcAovQ0lEU3lzdGVtSW5mbyA8PCAvUmVnaXN0cnkgKEFkb2JlKSAvT3JkZXJpbmcgKFVDUykgL1N1cHBsZW1lbnQgMCA+PiBkZWYKL0NNYXBOYW1lIC9BZG9iZS1JZGVudGl0eS1VQ1MgZGVmCi9DTWFwVHlwZSAyIGRlZgoxIGJlZ2luY29kZXNwYWNlcmFuZ2UKPDAwMDA+IDxGRkZGPgplbmRjb2Rlc3BhY2VyYW5nZQoyIGJlZ2luYmZyYW5nZQo8MDAwMD4gPDAwMDA+IDwwMDAwPgo8MDAwMT4gPDAwMDc+IFs8MDA3ND4gPDAwNjU+IDwwMDczPiA8MDAzMT4gPDAwMzg+IDwwMDMwPiA8MDAzMj4gXQplbmRiZnJhbmdlCmVuZGNtYXAKQ01hcE5hbWUgY3VycmVudGRpY3QgL0NNYXAgZGVmaW5lcmVzb3VyY2UgcG9wCmVuZAplbmQKCmVuZHN0cmVhbQplbmRvYmoKNiAwIG9iago8PCAvVHlwZSAvRm9udAovU3VidHlwZSAvVHlwZTAKL0Jhc2VGb250IC9EZWphVnVTYW5zCi9FbmNvZGluZyAvSWRlbnRpdHktSAovRGVzY2VuZGFudEZvbnRzIFsyMSAwIFJdCi9Ub1VuaWNvZGUgMjIgMCBSPj4KZW5kb2JqCjI0IDAgb2JqCjw8IC9UeXBlIC9Gb250RGVzY3JpcHRvcgovRm9udE5hbWUgL1FZQUFBQStEZWphVnVTYW5zLUJvbGQKL0ZsYWdzIDQgCi9Gb250QkJveCBbLTEwNjkuMzM1OTMgLTQxNS4wMzkwNjIgMTk3NS4wOTc2NSAxMTc0LjMxNjQwIF0KL0l0YWxpY0FuZ2xlIDAgCi9Bc2Nl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/j8Mu+f0w3q3DsnqSKicL3fLjLmqf/wk5H8B9Hzt0QplbmRzdHJlYW0KZW5kb2JqCjI4IDAgb2JqCjUyNTAKZW5kb2JqCjI2IDAgb2JqCjw8IC9UeXBlIC9Gb250Ci9TdWJ0eXBlIC9DSURGb250VHlwZTIKL0Jhc2VGb250IC9EZWphVnVTYW5zLUJvbGQKL0NJRFN5c3RlbUluZm8gPDwgL1JlZ2lzdHJ5IChBZG9iZSkgL09yZGVyaW5nIChJZGVudGl0eSkgL1N1cHBsZW1lbnQgMCA+PgovRm9udERlc2NyaXB0b3IgMjQgMCBSCi9DSURUb0dJRE1hcCAvSWRlbnRpdHkKL1cgWzAgWzU5NSA4MTQgNjkwIDY5MCA2OTAgNDEyIDY3NyA2NzggNzE0IDY5MCA2OTAgNjkwIF0KXQo+PgplbmRvYmoKMjcgMCBvYmoKPDwgL0xlbmd0aCA0NDEgPj4Kc3RyZWFtCi9DSURJbml0IC9Qcm9jU2V0IGZpbmRyZXNvdXJjZSBiZWdpbgoxMiBkaWN0IGJlZ2luCmJlZ2luY21hcAovQ0lEU3lzdGVtSW5mbyA8PCAvUmVnaXN0cnkgKEFkb2JlKSAvT3JkZXJpbmcgKFVDUykgL1N1cHBsZW1lbnQgMCA+PiBkZWYKL0NNYXBOYW1lIC9BZG9iZS1JZGVudGl0eS1VQ1MgZGVmCi9DTWFwVHlwZSAyIGRlZgoxIGJlZ2luY29kZXNwYWNlcmFuZ2UKPDAwMDA+IDxGRkZGPgplbmRjb2Rlc3BhY2VyYW5nZQoyIGJlZ2luYmZyYW5nZQo8MDAwMD4gPDAwMDA+IDwwMDAwPgo8MDAwMT4gPDAwMEI+IFs8MDA0Nz4gPDAwMzE+IDwwMDM0PiA8MDAzOT4gPDAwMkQ+IDwwMDU0PiA8MDA0NT4gPDAwNTM+IDwwMDM4PiA8MDAzMD4gPDAwMzI+IF0KZW5kYmZyYW5nZQplbmRjbWFwCkNNYXBOYW1lIGN1cnJlbnRkaWN0IC9DTWFwIGRlZmluZXJlc291cmNlIHBvcAplbmQKZW5kCgplbmRzdHJlYW0KZW5kb2JqCjExIDAgb2JqCjw8IC9UeXBlIC9Gb250Ci9TdWJ0eXBlIC9UeXBlMAovQmFzZUZvbnQgL0RlamFWdVNhbnMtQm9sZAovRW5jb2RpbmcgL0lkZW50aXR5LUgKL0Rlc2NlbmRhbnRGb250cyBbMjYgMCBSXQovVG9Vbmljb2RlIDI3IDAgUj4+CmVuZG9iagoyIDAgb2JqCjw8Ci9UeXBlIC9QYWdlcwovS2lkcyAKWwo1IDAgUgpdCi9Db3VudCAxCi9Qcm9jU2V0IFsvUERGIC9UZXh0IC9JbWFnZUIgL0ltYWdlQ10KPj4KZW5kb2JqCnhyZWYKMCAyOQowMDAwMDAwMDAwIDY1NTM1IGYgCjAwMDAwMDAwMDkgMDAwMDAgbiAKMDAwMDAxNzE2OCAwMDAwMCBuIAowMDAwMDAwMTYzIDAwMDAwIG4gCjAwMDAwMDAyNTggMDAwMDAgbiAKMDAwMDAwMzM0NiAwMDAwMCBuIAowMDAwMDEwNTA2IDAwMDAwIG4gCjAwMDAwMDAyOTUgMDAwMDAgbiAKMDAwMDAwMDY0OCAwMDAwMCBuIAowMDAwMDAwNjY3IDAwMDAwIG4gCjAwMDAwMDA5MDYgMDAwMDAgbiAKMDAwMDAxNzAyNiAwMDAwMCBuIAowMDAwMDAwOTI1IDAwMDAwIG4gCjAwMDAwMDMyNzUgMDAwMDAgbiAKMDAwMDAwMzI5NiAwMDAwMCBuIAowMDAwMDAzNjg4IDAwMDAwIG4gCjAwMDAwMDQzOTIgMDAwMDAgbiAKMDAwMDAwMzQ2NiAwMDAwMCBuIAowMDAwMDAzNjY4IDAwMDAwIG4gCjAwMDAwMDQ0MTIgMDAwMDAgbiAKMDAwMDAwNDY3MiAwMDAwMCBuIAowMDAwMDA5Nzk5IDAwMDAwIG4gCjAwMDAwMTAwNDEgMDAwMDAgbiAKMDAwMDAwOTc3OCAwMDAwMCBuIAowMDAwMDEwNjQyIDAwMDAwIG4gCjAwMDAwMTA5MDcgMDAwMDAgbiAKMDAwMDAxNjI3MCAwMDAwMCBuIAowMDAwMDE2NTMzIDAwMDAwIG4gCjAwMDAwMTYyNDkgMDAwMDAgbiAKdHJhaWxlcgo8PAovU2l6ZSAyOQovSW5mbyAxIDAgUgovUm9vdCAxNCAwIFIKPj4Kc3RhcnR4cmVmCjE3MjY2CiU";
            //Base64解码，replaceAll：去掉无用的空格，否则会导致解码的文件不可用
            byte[] b = new BASE64Decoder().decodeBuffer(string.replaceAll(" ", ""));
//            for (int i = 0; i < b.length; ++i) {
//                if (b[i] < 0) {
//                    //调整异常数据
//                    b[i] += 256;
//                }
//            }
            if (StringUtils.equals(type, "png")) {
                // 设置下载文件类型
                response.setHeader("content-Type", "image/png");
                // 设置下载文件名称后缀
                fileName = fileName.concat(".png");
            } else {
                response.setHeader("content-Type", "application/pdf");
                fileName = fileName.concat(".pdf");
            }
            // 设置文件下载方式，直接下载
            response.setHeader("Content-Disposition", "attachment;filename=" + fileName);
            // 设置文件大小，如果post请求，必须设置
            response.setHeader("Content-Length", String.valueOf(b.length));
            OutputStream out = response.getOutputStream();
            // 下载文件
            out.write(b);
            out.flush();
            out.close();
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    public static void main(String[] args) {




    }
}
